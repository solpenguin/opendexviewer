<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Token Details - OpenDex</title>
  <meta name="description" content="View token details, price charts, and community content">
  <meta name="theme-color" content="#07080a">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="css/styles.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-financial"></script>
</head>
<body>
  <header class="header">
    <div class="header-content">
      <a href="/" class="logo">
        <img src="OpenDEX_Logo.png" alt="OpenDex Logo" class="logo-img" width="28" height="28">
        <span class="logo-text">OpenDex</span>
        <span class="logo-badge">Beta</span>
      </a>

      <nav class="nav">
        <a href="/" class="nav-link">Tokens</a>
        <a href="submit.html" class="nav-link">Submit</a>
        <a href="about.html" class="nav-link">About</a>
        <a href="development.html" class="nav-link">Development</a>
        <a href="api.html" class="nav-link">API</a>
      </nav>

      <div class="header-actions">
        <button id="connect-wallet" class="btn">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="2" y="5" width="20" height="14" rx="2"/>
            <path d="M16 14a2 2 0 100-4 2 2 0 000 4z"/>
          </svg>
          Connect Wallet
        </button>
      </div>
    </div>
  </header>

  <main class="main token-page">
    <!-- Loading State -->
    <div id="loading-state" class="loading-state">
      <div class="loading-spinner large"></div>
      <p>Loading token data...</p>
    </div>

    <!-- Error State -->
    <div id="error-state" class="error-state" style="display: none;">
      <div class="error-icon">!</div>
      <h2>Token Not Found</h2>
      <p id="error-message">The requested token could not be found.</p>
      <a href="/" class="btn btn-primary">Back to Tokens</a>
    </div>

    <!-- Token Content (hidden until loaded) -->
    <div id="token-content" style="display: none;">
      <!-- Token Header -->
      <section class="token-header">
        <div class="token-header-left">
          <img id="token-logo" class="token-logo-large" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'%3E%3Ccircle cx='16' cy='16' r='16' fill='%23181b23'/%3E%3Ctext x='16' y='21' text-anchor='middle' fill='%235d6577' font-size='14'%3E?%3C/text%3E%3C/svg%3E" alt="Token Logo">
          <div class="token-info-header">
            <div class="token-name-row">
              <h1 id="token-name">Loading...</h1>
              <span id="token-symbol" class="token-symbol-badge">---</span>
            </div>
            <div class="token-address-row">
              <span id="token-address" class="token-address" title="Click to copy">---</span>
              <button id="copy-address" class="btn-icon" title="Copy address">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                  <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                </svg>
              </button>
              <a id="explorer-link" href="#" target="_blank" class="btn-icon" title="View on Solscan">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                  <polyline points="15 3 21 3 21 9"></polyline>
                  <line x1="10" y1="14" x2="21" y2="3"></line>
                </svg>
              </a>
              <button id="watchlist-btn" class="btn-icon watchlist-btn-header" title="Add to watchlist">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
                </svg>
              </button>
            </div>
          </div>
        </div>
        <div class="token-header-right">
          <div class="token-price-container">
            <span id="token-price" class="token-price-large">$0.00</span>
            <span id="price-change" class="price-change-badge">0%</span>
          </div>
          <div id="price-freshness" class="price-freshness" title="Price refresh status">
            <span class="freshness-dot"></span>
            <span class="freshness-text">Updated just now</span>
            <span class="countdown"></span>
          </div>
          <div class="price-stats-mini">
            <div class="price-stat-mini">
              <span class="label">24h High</span>
              <span id="price-high" class="value">--</span>
            </div>
            <div class="price-stat-mini">
              <span class="label">24h Low</span>
              <span id="price-low" class="value">--</span>
            </div>
          </div>
        </div>
      </section>

    <!-- Combined Community Section (Banner + Links) -->
    <section id="community-section" class="community-section" style="display: none;">
      <div class="community-section-header">
        <h2>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
            <circle cx="9" cy="7" r="4"></circle>
            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
          </svg>
          Community
        </h2>
        <a id="submit-community-link" href="submit.html" class="btn btn-sm">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line>
          </svg>
          Contribute
        </a>
      </div>

      <!-- Banner Display -->
      <div id="banner-wrapper" class="community-banner-wrapper" style="display: none;">
        <img id="community-banner" class="community-banner" src="" alt="Community Banner">
        <div class="banner-voting">
          <button class="vote-btn vote-up" data-vote="up">
            <span class="vote-icon">▲</span>
            <span class="vote-count" id="banner-upvotes">0</span>
          </button>
          <button class="vote-btn vote-down" data-vote="down">
            <span class="vote-icon">▼</span>
            <span class="vote-count" id="banner-downvotes">0</span>
          </button>
        </div>
      </div>

      <!-- Community Links -->
      <div id="community-links" class="community-links-inline"></div>
    </section>

      <!-- Main Content Grid -->
      <div class="token-content-grid">
        <!-- Chart Section -->
        <section class="chart-section">
          <div class="chart-header">
            <div class="chart-title-row">
              <h2 id="chart-title">Price Chart</h2>
              <div class="chart-controls">
                <div class="chart-metric-toggle">
                  <button class="chart-metric-btn active" data-metric="price" title="Price">Price</button>
                  <button class="chart-metric-btn" data-metric="mcap" title="Market Cap">MCap</button>
                </div>
                <div class="chart-type-toggle">
                  <button class="chart-type-btn active" data-type="line" title="Line Chart">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                    </svg>
                  </button>
                  <button class="chart-type-btn" data-type="candle" title="Candlestick Chart">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <rect x="4" y="8" width="4" height="8"></rect>
                      <line x1="6" y1="4" x2="6" y2="8"></line>
                      <line x1="6" y1="16" x2="6" y2="20"></line>
                      <rect x="16" y="6" width="4" height="10"></rect>
                      <line x1="18" y1="2" x2="18" y2="6"></line>
                      <line x1="18" y1="16" x2="18" y2="22"></line>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
            <div class="chart-timeframes">
              <button class="timeframe-btn" data-interval="15m">15M</button>
              <button class="timeframe-btn active" data-interval="1h">1H</button>
              <button class="timeframe-btn" data-interval="4h">4H</button>
              <button class="timeframe-btn" data-interval="1d">1D</button>
              <button class="timeframe-btn" data-interval="1w">1W</button>
            </div>
          </div>
          <div class="chart-container">
            <div id="chart-loading" class="chart-loading">
              <div class="loading-spinner"></div>
            </div>
            <canvas id="price-chart"></canvas>
          </div>
          <div class="chart-stats">
            <div class="chart-stat">
              <span class="label">Open</span>
              <span id="chart-open" class="value">--</span>
            </div>
            <div class="chart-stat">
              <span class="label">High</span>
              <span id="chart-high" class="value">--</span>
            </div>
            <div class="chart-stat">
              <span class="label">Low</span>
              <span id="chart-low" class="value">--</span>
            </div>
            <div class="chart-stat">
              <span class="label">Close</span>
              <span id="chart-close" class="value">--</span>
            </div>
            <div class="chart-stat">
              <span class="label">Volume</span>
              <span id="chart-volume" class="value">--</span>
            </div>
          </div>
        </section>

        <!-- Stats Section -->
        <section class="stats-section">
          <h2>Token Statistics</h2>
          <div class="stats-grid">
            <div class="stat-card">
              <span class="stat-label">Market Cap</span>
              <span id="stat-mcap" class="stat-value">--</span>
            </div>
            <div class="stat-card">
              <span class="stat-label">24h Volume</span>
              <span id="stat-volume" class="stat-value">--</span>
            </div>
            <div class="stat-card">
              <span class="stat-label">Total Liquidity</span>
              <span id="stat-liquidity" class="stat-value">--</span>
            </div>
            <div class="stat-card">
              <span class="stat-label">Holders</span>
              <span id="stat-holders" class="stat-value">--</span>
            </div>
            <div class="stat-card">
              <span class="stat-label">Total Supply</span>
              <span id="stat-supply" class="stat-value">--</span>
            </div>
            <div class="stat-card">
              <span class="stat-label">Circulating</span>
              <span id="stat-circulating" class="stat-value">--</span>
            </div>
            <div class="stat-card">
              <span class="stat-label">Page Views</span>
              <span id="stat-views" class="stat-value">--</span>
            </div>
          </div>
        </section>

        <!-- Pools Section -->
        <section class="pools-section">
          <h2>Liquidity Pools</h2>
          <div id="pools-loading" class="pools-loading">
            <div class="loading-spinner"></div>
            <span>Loading pools...</span>
          </div>
          <div id="pools-list" class="pools-list" style="display: none;"></div>
          <p id="pools-empty" class="pools-empty" style="display: none;">No liquidity pools found for this token.</p>
        </section>

        <!-- Trade Section -->
        <section class="trade-section">
          <h2>Trade</h2>
          <div class="trade-links">
            <a id="jupiter-link" href="#" target="_blank" class="trade-btn jupiter">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <circle cx="12" cy="12" r="10"/>
              </svg>
              Trade on Jupiter
            </a>
          </div>
        </section>

      </div>

      <!-- All Submissions Section -->
      <section class="submissions-section">
        <div class="submissions-header">
          <div class="submissions-header-left">
            <h2>Community Submissions</h2>
            <span id="submissions-count" class="submissions-count">0 submissions</span>
          </div>
          <button id="voting-info-btn" class="btn btn-ghost btn-sm" onclick="voting.showVotingInfoModal()" title="How voting works">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <line x1="12" y1="16" x2="12" y2="12"/>
              <line x1="12" y1="8" x2="12.01" y2="8"/>
            </svg>
            How Voting Works
          </button>
        </div>
        <div class="submissions-tabs">
          <button class="submissions-tab active" data-type="banner">Banners</button>
          <button class="submissions-tab" data-type="social">Social Links</button>
        </div>
        <div id="submissions-list" class="submissions-list">
          <p class="no-submissions">No submissions yet. Be the first to contribute!</p>
        </div>
      </section>
    </div>
  </main>

  <footer class="footer">
    <div class="footer-content">
      <p>&copy; 2026 OpenDex - Open Source Token Viewer</p>
      <div class="footer-links">
        <a href="https://github.com/SolPenguin/opendexviewer" target="_blank">GitHub</a>
        <span class="separator">|</span>
        <a href="docs/API.md" target="_blank">API Docs</a>
      </div>
    </div>
  </footer>

  <script src="js/config.js"></script>
  <script src="js/api.js"></script>
  <script src="js/wallet.js"></script>
  <script src="js/watchlist.js"></script>
  <script src="js/voting.js"></script>
  <script src="js/tokenDetail.js"></script>
</body>
</html>
