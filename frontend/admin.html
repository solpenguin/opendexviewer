<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Admin Panel - OpenDex</title>
  <meta name="robots" content="noindex, nofollow">
  <meta name="theme-color" content="#07080a">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="css/admin.css">
</head>
<body class="admin-body">
  <!-- Login Screen -->
  <div id="login-screen" class="admin-login">
    <div class="login-container">
      <div class="login-header">
        <svg width="48" height="48" viewBox="0 0 32 32" fill="none">
          <rect width="32" height="32" rx="8" fill="url(#logo-gradient)"/>
          <path d="M10 16L14 12L18 16L22 12" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
          <path d="M10 20L14 16L18 20L22 16" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" opacity="0.5"/>
          <defs>
            <linearGradient id="logo-gradient" x1="0" y1="0" x2="32" y2="32">
              <stop stop-color="#6366f1"/>
              <stop offset="1" stop-color="#a855f7"/>
            </linearGradient>
          </defs>
        </svg>
        <h1>OpenDex Admin</h1>
        <p>Enter your admin password to continue</p>
      </div>

      <form id="login-form" class="login-form">
        <div class="form-group">
          <label for="password">Password</label>
          <input type="password" id="password" name="password" placeholder="Enter admin password" autocomplete="current-password" required>
        </div>
        <div id="login-error" class="form-error" style="display: none;"></div>
        <button type="submit" class="btn btn-primary btn-full">
          <span class="btn-text">Sign In</span>
          <span class="btn-loading" style="display: none;">
            <span class="loading-spinner small"></span>
            Authenticating...
          </span>
        </button>
      </form>

      <div class="login-footer">
        <a href="/">Back to OpenDex</a>
      </div>
    </div>
  </div>

  <!-- Admin Panel (hidden until authenticated) -->
  <div id="admin-panel" class="admin-panel" style="display: none;">
    <header class="admin-header">
      <div class="admin-header-left">
        <a href="/" class="admin-logo">
          <svg width="28" height="28" viewBox="0 0 32 32" fill="none">
            <rect width="32" height="32" rx="8" fill="url(#logo-gradient2)"/>
            <path d="M10 16L14 12L18 16L22 12" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M10 20L14 16L18 20L22 16" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" opacity="0.5"/>
            <defs>
              <linearGradient id="logo-gradient2" x1="0" y1="0" x2="32" y2="32">
                <stop stop-color="#6366f1"/>
                <stop offset="1" stop-color="#a855f7"/>
              </linearGradient>
            </defs>
          </svg>
          <span>OpenDex</span>
          <span class="admin-badge">Admin</span>
        </a>
      </div>

      <div class="admin-header-right">
        <button id="logout-btn" class="btn btn-ghost">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"/>
            <polyline points="16 17 21 12 16 7"/>
            <line x1="21" y1="12" x2="9" y2="12"/>
          </svg>
          Logout
        </button>
      </div>
    </header>

    <div class="admin-content">
      <nav class="admin-nav">
        <button class="admin-nav-item active" data-tab="dashboard">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="7" height="9"/>
            <rect x="14" y="3" width="7" height="5"/>
            <rect x="14" y="12" width="7" height="9"/>
            <rect x="3" y="16" width="7" height="5"/>
          </svg>
          Dashboard
        </button>
        <button class="admin-nav-item" data-tab="submissions">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/>
            <polyline points="14 2 14 8 20 8"/>
            <line x1="16" y1="13" x2="8" y2="13"/>
            <line x1="16" y1="17" x2="8" y2="17"/>
            <polyline points="10 9 9 9 8 9"/>
          </svg>
          Submissions
          <span id="pending-badge" class="nav-badge" style="display: none;">0</span>
        </button>
        <button class="admin-nav-item" data-tab="api-keys">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 11-7.778 7.778 5.5 5.5 0 017.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"/>
          </svg>
          API Keys
        </button>
        <button class="admin-nav-item" data-tab="tokens">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <path d="M12 6v6l4 2"/>
          </svg>
          Tokens
        </button>
        <button class="admin-nav-item" data-tab="settings">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="3"/>
            <path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"/>
          </svg>
          Settings
        </button>
      </nav>

      <main class="admin-main">
        <!-- Dashboard Tab -->
        <div id="tab-dashboard" class="admin-tab active">
          <div class="tab-header">
            <h2>Dashboard</h2>
            <button id="refresh-stats" class="btn btn-ghost btn-sm">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 12a9 9 0 11-9-9c2.52 0 4.93 1 6.74 2.74L21 8"/>
                <path d="M21 3v5h-5"/>
              </svg>
              Refresh
            </button>
          </div>

          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-icon pending">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"/>
                  <polyline points="12 6 12 12 16 14"/>
                </svg>
              </div>
              <div class="stat-content">
                <span class="stat-label">Pending</span>
                <span id="stat-pending" class="stat-value">--</span>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon approved">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M22 11.08V12a10 10 0 11-5.93-9.14"/>
                  <polyline points="22 4 12 14.01 9 11.01"/>
                </svg>
              </div>
              <div class="stat-content">
                <span class="stat-label">Approved</span>
                <span id="stat-approved" class="stat-value">--</span>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon rejected">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"/>
                  <line x1="15" y1="9" x2="9" y2="15"/>
                  <line x1="9" y1="9" x2="15" y2="15"/>
                </svg>
              </div>
              <div class="stat-content">
                <span class="stat-label">Rejected</span>
                <span id="stat-rejected" class="stat-value">--</span>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon total">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/>
                  <polyline points="14 2 14 8 20 8"/>
                </svg>
              </div>
              <div class="stat-content">
                <span class="stat-label">Total Submissions</span>
                <span id="stat-total" class="stat-value">--</span>
              </div>
            </div>
          </div>

          <div class="stats-row">
            <div class="stat-card wide">
              <div class="stat-icon info">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M22 12h-4l-3 9L9 3l-3 9H2"/>
                </svg>
              </div>
              <div class="stat-content">
                <span class="stat-label">Total Votes</span>
                <span id="stat-votes" class="stat-value">--</span>
              </div>
            </div>
            <div class="stat-card wide">
              <div class="stat-icon info">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="10"/>
                  <line x1="12" y1="8" x2="12" y2="12"/>
                  <line x1="12" y1="16" x2="12.01" y2="16"/>
                </svg>
              </div>
              <div class="stat-content">
                <span class="stat-label">Tracked Tokens</span>
                <span id="stat-tokens" class="stat-value">--</span>
              </div>
            </div>
            <div class="stat-card wide">
              <div class="stat-icon info">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 11-7.778 7.778 5.5 5.5 0 017.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"/>
                </svg>
              </div>
              <div class="stat-content">
                <span class="stat-label">API Keys (Active)</span>
                <span id="stat-apikeys" class="stat-value">--</span>
              </div>
            </div>
          </div>

          <div class="activity-section">
            <h3>Recent Activity (24h)</h3>
            <div class="activity-stats">
              <div class="activity-item">
                <span class="activity-label">New Submissions</span>
                <span id="stat-recent-submissions" class="activity-value">--</span>
              </div>
              <div class="activity-item">
                <span class="activity-label">New Votes</span>
                <span id="stat-recent-votes" class="activity-value">--</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Submissions Tab -->
        <div id="tab-submissions" class="admin-tab">
          <div class="tab-header">
            <h2>Submissions</h2>
            <div class="tab-actions">
              <select id="submission-filter" class="form-select">
                <option value="">All Status</option>
                <option value="pending">Pending</option>
                <option value="approved">Approved</option>
                <option value="rejected">Rejected</option>
              </select>
              <button id="refresh-submissions" class="btn btn-ghost btn-sm">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 12a9 9 0 11-9-9c2.52 0 4.93 1 6.74 2.74L21 8"/>
                  <path d="M21 3v5h-5"/>
                </svg>
                Refresh
              </button>
            </div>
          </div>

          <div class="table-container">
            <table class="admin-table">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Token</th>
                  <th>Type</th>
                  <th>Content</th>
                  <th>Score</th>
                  <th>Status</th>
                  <th>Created</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="submissions-table">
                <tr class="loading-row">
                  <td colspan="8">
                    <div class="loading-state">
                      <div class="loading-spinner"></div>
                      <span>Loading submissions...</span>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="table-pagination">
            <div class="pagination-info">
              <span id="submissions-info">Showing 0 of 0</span>
            </div>
            <div class="pagination-controls">
              <button id="submissions-prev" class="btn btn-ghost btn-sm" disabled>Previous</button>
              <span id="submissions-page" class="pagination-page">Page 1</span>
              <button id="submissions-next" class="btn btn-ghost btn-sm">Next</button>
            </div>
          </div>
        </div>

        <!-- API Keys Tab -->
        <div id="tab-api-keys" class="admin-tab">
          <div class="tab-header">
            <h2>API Keys</h2>
            <button id="refresh-apikeys" class="btn btn-ghost btn-sm">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 12a9 9 0 11-9-9c2.52 0 4.93 1 6.74 2.74L21 8"/>
                <path d="M21 3v5h-5"/>
              </svg>
              Refresh
            </button>
          </div>

          <div class="table-container">
            <table class="admin-table">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Key Prefix</th>
                  <th>Owner Wallet</th>
                  <th>Name</th>
                  <th>Requests</th>
                  <th>Status</th>
                  <th>Created</th>
                  <th>Last Used</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="apikeys-table">
                <tr class="loading-row">
                  <td colspan="9">
                    <div class="loading-state">
                      <div class="loading-spinner"></div>
                      <span>Loading API keys...</span>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="table-pagination">
            <div class="pagination-info">
              <span id="apikeys-info">Showing 0 of 0</span>
            </div>
            <div class="pagination-controls">
              <button id="apikeys-prev" class="btn btn-ghost btn-sm" disabled>Previous</button>
              <span id="apikeys-page" class="pagination-page">Page 1</span>
              <button id="apikeys-next" class="btn btn-ghost btn-sm">Next</button>
            </div>
          </div>
        </div>

        <!-- Tokens Tab -->
        <div id="tab-tokens" class="admin-tab">
          <div class="tab-header">
            <h2>Tokens</h2>
            <button id="refresh-tokens" class="btn btn-ghost btn-sm">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 12a9 9 0 11-9-9c2.52 0 4.93 1 6.74 2.74L21 8"/>
                <path d="M21 3v5h-5"/>
              </svg>
              Refresh
            </button>
          </div>

          <div class="table-container">
            <table class="admin-table">
              <thead>
                <tr>
                  <th>Token</th>
                  <th>Symbol</th>
                  <th>Mint Address</th>
                  <th>Submissions</th>
                  <th>Pending</th>
                  <th>Created</th>
                </tr>
              </thead>
              <tbody id="tokens-table">
                <tr class="loading-row">
                  <td colspan="6">
                    <div class="loading-state">
                      <div class="loading-spinner"></div>
                      <span>Loading tokens...</span>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="table-pagination">
            <div class="pagination-info">
              <span id="tokens-info">Showing 0 of 0</span>
            </div>
            <div class="pagination-controls">
              <button id="tokens-prev" class="btn btn-ghost btn-sm" disabled>Previous</button>
              <span id="tokens-page" class="pagination-page">Page 1</span>
              <button id="tokens-next" class="btn btn-ghost btn-sm">Next</button>
            </div>
          </div>
        </div>

        <!-- Settings Tab -->
        <div id="tab-settings" class="admin-tab">
          <div class="tab-header">
            <h2>Settings</h2>
          </div>

          <div class="settings-section">
            <h3>Development Mode</h3>
            <p class="settings-description">When enabled, token holder verification is bypassed for submissions. This allows testing without needing to hold tokens.</p>

            <div class="setting-row">
              <div class="setting-info">
                <span class="setting-label">Development Mode</span>
                <span class="setting-hint">Bypass holder verification for submissions</span>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" id="dev-mode-toggle">
                <span class="toggle-slider"></span>
              </label>
            </div>

            <div id="dev-mode-warning" class="setting-warning" style="display: none;">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/>
                <line x1="12" y1="9" x2="12" y2="13"/>
                <line x1="12" y1="17" x2="12.01" y2="17"/>
              </svg>
              <span>Development mode is active. Token holder verification is bypassed.</span>
            </div>
          </div>

          <div class="settings-section">
            <h3>Manual Approval</h3>
            <p class="settings-description">As an admin, you can manually approve any pending submission regardless of vote counts or verification status. Use the Submissions tab to approve/reject submissions.</p>
          </div>
        </div>
      </main>
    </div>
  </div>

  <!-- Confirmation Modal -->
  <div id="confirm-modal" class="modal" style="display: none;">
    <div class="modal-backdrop"></div>
    <div class="modal-content">
      <h3 id="confirm-title">Confirm Action</h3>
      <p id="confirm-message">Are you sure you want to proceed?</p>
      <div class="modal-actions">
        <button id="confirm-cancel" class="btn btn-ghost">Cancel</button>
        <button id="confirm-ok" class="btn btn-danger">Confirm</button>
      </div>
    </div>
  </div>

  <script src="js/config.js"></script>
  <script src="js/api.js"></script>
  <script src="js/admin.js"></script>
</body>
</html>
